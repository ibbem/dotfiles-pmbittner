# We use the following file as a variable to toggle whether we run emacs as a standalone tool or as a client/server.
# DISABLE_EMACS_SERVER_USAGE_FILE="$HOME/.local/state/paul_disables_emacs_server_usage" emacs-toggle-server() {
#   if [ -f "$DISABLE_EMACS_SERVER_USAGE_FILE" ]
#   then
#     rm "$DISABLE_EMACS_SERVER_USAGE_FILE"
#     echo "START emacs server mode"
#     emacs-start-server
#   else
#     touch "$DISABLE_EMACS_SERVER_USAGE_FILE"
#     echo "STOP emacs server mode. Running servers are terminated."
#     emacs-kill-server
#   fi
# }
# is-emacs-server() {
#   if [ -f "$DISABLE_EMACS_SERVER_USAGE_FILE" ]
#   then
#     echo "No, emacs will be run as standalone."
#   else
#     echo "Yes, emacs will run as client."
#   fi
# }
emacs-start-server() {
  pgrep emacs > /dev/null || emacs --daemon
}
emacs-kill-server() {
  pkill emacs
}
emacs-restart-server() {
  emacs-kill-server
  sleep 1
  emacs-start-server
}
# shuts down all emacs servers, runs 'doom sync', and restarts server
emacs-sync() {
  emacs-kill-server
  doom sync
  # if [ -f "$DISABLE_EMACS_SERVER_USAGE_FILE" ]
  # then
  # else
    emacs-start-server
  # fi
}

my-emacs-client-alias() {
  # if [ -f "$DISABLE_EMACS_SERVER_USAGE_FILE" ]
  # then
    # (cd "$@" ; emacs &!)
  # else
    # emacs-start-server
    emacsclient --create-frame --alternate-editor='emacs' "$@" &!
  # fi
}
open-emacs-here() {
  # if there are no arguments,
  if [ "$#" -eq 0 ]
  then
    # start emacs at the current directory,
    my-emacs-client-alias .
  else
    # otherwise, open emacs with the supplied arguments.
    my-emacs-client-alias "$@"
  fi
}

alias e='my-emacs-client-alias'
alias es='emacs-sync'
alias er='emacs-sync ; e'
alias ers='emacs-restart-server'
alias doom-reload='er'
alias ds='doom sync'
alias doc='doom doctor'
